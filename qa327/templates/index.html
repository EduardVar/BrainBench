{% extends 'base.html' %}
{% from "macros/modal.jinja" import modal %}

{% block header %}
<h1>{% block title %}Profile{% endblock %}</h1>
{% endblock %}

{% block content %}
<header class="sub-header">
    <h2 id="welcome-header">Welcome {{ user.name }} {{user.id}} !</h2>
    <button class="btn btn-primary"><a href='/logout'>Logout</a></button>
</header>

<section id="main" class="my-4">
    <div class="container mb-2">
        <div class="row">
            <div class="col">
                <h3>Purchase Tickets</h3>
            </div>
        </div>
    </div>
    <table class="available-to-buy table mb-3">
        <thead class="thread-light">
            <tr>
                <th scope="col">Ticket Name</th>
                <th scope="col">Available</th>
                <th scope="col" r>Purchase</th>
            </tr>
        </thead>
        <tbody>
            {% if not tickets == None %}
                {% for ticket in tickets %}
                    <tr class="ticket">
                        <td class="ticket-name" scope="row">{{ticket.name}}</td>
                        <td class="ticket-quantity-available">{{ticket.quantity}}</td>
                        <td><button class="purchase-ticket">Buy Ticket</button></td>
                    </tr>
                {% endfor %}
            {% else %}
            <tr>
                <td colspan="100%" class="text-center p-4">:( Looks like there are none available</td>
            </tr>
            {% endif %}
        </tbody>
    </table>

    <div class="container mb-2">
        <div class="row">
            <div class="col-8">
                <h3>Update Ticket</h3>
            </div>
            <div class="col">
                <button type="button" class="btn btn-primary mx-3" data-target="#submit-modal" data-toggle="modal">Add New Ticket</button>
            </div>
        </div>
    </div>
    <table class="table mb-3">
        <thead>
            <tr>
                <td>Name</td>
                <td>Quantity</td>
                <td>Price</td>
                <td>Date</td>
                <td>Buy Ticket</td>
            </tr>
        </thead>
        <tbody>
            {% if not tickets == None %}
            {% for ticket in tickets|select("equalto", user.id) %}
                <tr>
                    <td>{{ticket.name}}</td>
                    <td>{{ticket.quantity}}</td>
                    <td>{{ticket.price}}</td>
                    <td>{{ticket.date}}</td>
                    <td><button class="btn btn-primary" onclick='loadUpdateModal({{ticket.name}}, {{ticket.quantity}}, {{ticket.price}}, {{ticket.date}})'></button></td>
                </tr>
            {% endfor %}
            {% endif %}
        </tbody>
    </table>

    <section class="ticket_actions container d-flex justify-content-center" role="group">
        <button type="button" class="btn btn-primary mx-3" data-target="#update-modal" data-toggle="modal"
            id="submit_new_tickets">Update Tickets</button>
            <!-- {% if ticket == None %} disabled {% endif %} put that back into update tickets -->
        <button type="button" class="btn btn-primary mx-3" data-target="#submit-modal" data-toggle="modal"
            id="update_tickets">Add Tickets</button>
    </section>
</section>

{{ modal("update", "Update Ticket") }}
{{ modal("submit", "Add New Ticket") }}

<script src=" {{ url_for('static', filename='js/display_elements.js') }}"></script>
{% endblock %}
